# -*- coding: utf-8 -*-
"""experiment_t5_abs_summarization.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1VfVJBW__9QI1h4hGmbOOQOnrjVYWUFGb
"""

!pip install torch transformers urllib3

import torch
from transformers import AutoTokenizer, AutoModelWithLMHead
import urllib3

tokenizer=AutoTokenizer.from_pretrained('T5-base')
model=AutoModelWithLMHead.from_pretrained('T5-base', return_dict=True)

git_repo = input('git_repo url : ')
git_repo = git_repo.replace("github.com", "raw.githubusercontent.com")
git_repo = git_repo + "/master/README.md"

http = urllib3.PoolManager()
r = http.request('GET', git_repo, preload_content=False)
prompt = str(r.read()) + "\nsummarize: "
prompt = str(prompt)
r.release_conn()

inputs=tokenizer.encode(prompt, return_tensors='pt', max_length=1024, truncation=True)

output = model.generate(inputs, min_length=256, max_length=512)

summary=tokenizer.decode(output[0], skip_special_tokens=True)

print("README : ")
print(str(prompt))

print("Summary : ")
print(summary)

